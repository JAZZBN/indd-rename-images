// ------------------------------------------------------------------------------------------------------------------ //Description:Geht die markierten Bilder durch und fragt nach einem neuen Namen für die Bilddatei// [Ver. 1]  // [Autor: Gerald Singelmann. ] // [Lang: DE]  // [Getestet mit: InDesign CC2019]  // [Creat: 19-11-04]  // Bugs & Feedback : gs@cuppascript.com // www.cuppascript.com // ------------------------------------------------------------------------------------------------------------------ if ( app.selection.length )	main();function main() {	var sels = [];	for ( var ns = 0; ns < app.selection.length; ns++) sels[ns] = app.selection[ns];	for ( var ns = 0; ns < sels.length; ns++) {		var s = sels[ns];		for ( var ng = 0; ng < s.allGraphics.length; ng++ ) {			var g = s.allGraphics[ng];			app.select(g);			var l = g.itemLink;			if ( l.isValid ) {				var nm = l.name.split(".");				var ext = nm.pop();				nm = nm.join(".");				var fp = l.filePath;				var f = (fp instanceof File) ? fp : new File( fp );				var ls = prop( LinkStatus, l.status );				if ( ls.toLowerCase() == "normal" ) {					var nu_nm = prompt ("Wie soll das Bild heißen?", nm);					if ( nu_nm != null && nu_nm != nm ) {						var done = f.rename( nu_nm + "." + ext );						if ( done ) {							l.relink( f );						}	// did rename					}		// neuer name				}			// link status normal			}				// link valid		}					// graphics loop	}						// selection loop	app.select( sels );}function prop (base, value) {   var props = base.reflect.properties;   var array = [];   for (var i = 0; i < props.length; i++)   {    if (base[props[i].name] == value) return props[i].name;   }   return String(value);}